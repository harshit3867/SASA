<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Zippee – Live Projection Report</title>

<style>
:root{
    --primary:#003f8c;
    --glass:rgba(255,255,255,0.22);
    --shadow:0 12px 35px rgba(0,0,0,.2);
}

*{box-sizing:border-box;}

html,body{
    margin:0;
    font-family:"Segoe UI",Arial;
}

body{
    background:url('Zippee.png') center/cover fixed no-repeat;
}

body::before{
    content:"";
    position:fixed;
    inset:0;
    background:rgba(255,255,255,.28);
    backdrop-filter:blur(6px);
    z-index:-1;
}

/* HEADER */
.header{
    background:linear-gradient(90deg,#003f8c,#0059b3);
    color:white;
    padding:16px 28px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.logo{height:44px;}

/* CARD */
.card{
    background:var(--glass);
    backdrop-filter:blur(14px) saturate(130%);
    margin:30px auto;
    max-width:1100px;
    padding:26px;
    border-radius:18px;
    box-shadow:var(--shadow);
}

.title{
    font-size:22px;
    font-weight:800;
    color:var(--primary);
}

/* CONTROLS */
.controls{
    display:flex;
    align-items:center;
    gap:12px;
    margin-top:12px;
}

.button{
    background:linear-gradient(135deg,#0a66c2,#0078ff);
    border:none;
    border-radius:10px;
    padding:10px 18px;
    color:white;
    font-weight:700;
    cursor:pointer;
}

#status{
    font-weight:700;
    color:#0a66c2;
}

/* REPORT */
#captureBox{
    position:relative;
    margin-top:20px;
}

/* HEAD */
.report-head{
    text-align:center;
    margin-bottom:12px;
}

.report-title{
    font-size:20px;
    font-weight:900;
}

.report-meta{
    font-size:13px;
    opacity:.8;
}

/* WATERMARK */
.watermark{
    position:absolute;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    pointer-events:none;
}

.watermark span{
    font-size:42px;
    font-weight:900;
    color:rgba(0,0,0,0.06);
    transform:rotate(-25deg);
    text-align:center;
}

/* TABLE — FIXED */
table{
    width:100%;
    border-collapse:collapse;
    background:white;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 8px 20px rgba(0,0,0,.15);
}

th,td{
    padding:10px 8px;
    border:1px solid #e3e6eb;
    font-size:13px;
    text-align:center;

    /* CRITICAL FIX */
    white-space:nowrap;
}

th{
    background:#f4f6f9;
    font-weight:800;
    white-space:normal;
    line-height:1.3;
}

/* FOOTER */
.report-footer{
    margin-top:12px;
    text-align:center;
    font-size:12px;
    font-weight:700;
    opacity:.7;
}

/* RESPONSIVE */
@media(max-width:768px){
    th,td{font-size:12px;padding:8px;}
    .title{font-size:20px;}
}
</style>
</head>

<body>

<div class="header">
    <h1>Zippee – Live Report</h1>
    <img class="logo" src="https://i.imgur.com/7yUVE8U.png">
</div>

<div class="card">
    <div class="title">Live Order Projections</div>

    <div class="controls">
        <button class="button" onclick="fetchSheet()">Refresh</button>
        <span id="status">—</span>
    </div>

    <div id="captureBox">
        <div class="report-head">
            <div class="report-title">Projected Orders</div>
            <div class="report-meta" id="metaInfo"></div>
        </div>

        <div class="watermark">
            <span>Zippee<br>SASA</span>
        </div>

        <table id="reportTable"></table>

        <div class="report-footer">
            Auto-refresh every 60 seconds
        </div>
    </div>
</div>

<script>
const SHEET_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vT9TO8jCWfO7hdQXF5vmwdOj7-VnsTZ-gtSGVfeO2ZepA6Za23hS2P7eCZUKX5vZBl6nWUexc5sPny5/pub?gid=0&single=true&output=csv";

const REFRESH_INTERVAL = 60000;

async function fetchSheet(){
    document.getElementById("status").innerText="Loading...";
    try{
        const res=await fetch(SHEET_URL+"&t="+Date.now());
        const csv=await res.text();
        const rows=csv.trim().split("\n").map(r=>r.split(","));
        renderTable(rows);
        updateMeta();
        document.getElementById("status").innerText="Live";
    }catch{
        document.getElementById("status").innerText="Error";
    }
}

function renderTable(data){
    const table=document.getElementById("reportTable");
    table.innerHTML="";
    data.forEach((row,i)=>{
        const tr=document.createElement("tr");
        row.forEach(cell=>{
            const el=document.createElement(i===0?"th":"td");
            el.textContent=cell;
            tr.appendChild(el);
        });
        table.appendChild(tr);
    });
}

function updateMeta(){
    const now=new Date();
    metaInfo.innerText=
        `${now.toDateString()} | ${now.toLocaleTimeString()}`;
}

fetchSheet();
setInterval(fetchSheet,REFRESH_INTERVAL);
</script>

</body>
</html>
