<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Store Projected Orders Report</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>

  /* Make final table section full screen width */
.full-width-table{
    width: 100vw;                 /* full screen */
    max-width: 100vw;
    margin-left: calc(-50vw + 50%);
    margin-right: calc(-50vw + 50%);
    border-radius: 0;             /* optional, looks cleaner */
}
/* Final merged table header styling */
#finalTable thead th{
    background: #0b4ea2;   /* Zippee blue */
    color: #ffffff;
    font-weight: 600;
    text-align: center;
    padding: 10px 8px;
    border-bottom: 2px solid #083b7a;
    white-space: normal;
    line-height: 1.3;
}
/* Final table watermark footer */
.table-watermark-row td {
    background: #fff;
    color: #999;
    font-size: 12px;
    font-style: italic;
    text-align: center;
    padding: 8px 0;
    border-top: 1px dashed #ddd;
}

/* Final Merged Table Header Styling */
.final-merged-table thead tr {
    background: #ff9800;   /* orange */
}

.final-merged-table thead th {
    color: #000;           /* readable text */
    font-weight: 700;
    text-align: center;
    vertical-align: middle;
    border: 1px solid #e68900;
}

/* Left align store name header */
#finalTable thead th:first-child{
    text-align: left;
}

/* ================= GLOBAL ================= */
body{
    margin:0;
    font-family:"Segoe UI", Arial;
    background:url('Zippee.png') center/cover fixed no-repeat;
    display:flex;
    flex-direction:column;
    align-items:center;
}

body::before{
    content:"";
    position:fixed;
    inset:0;
    background:rgba(255,255,255,0.25);
    backdrop-filter:blur(6px);
    z-index:-1;
}

/* ================= HEADER ================= */
.zippee-header{
    width:100%;
    background:linear-gradient(90deg,#003f8c,#0059b3);
    color:white;
    padding:16px 32px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.zippee-header h1{
    margin:0;
    font-size:22px;
}

/* ================= MAIN CONTAINER ================= */
.main-container{
    width:100%;
    max-width:2000px;
    padding:20px;
}
.table-scroll{
    width:100%;
    overflow-x:auto;
}

.table-scroll table{
    min-width:1400px;
}
.clean-table input{
    width:80px;
    padding:4px 6px;
    font-size:13px;
    box-sizing:border-box;
}
.table-scroll{
    width: 100%;
    overflow-x: auto;
}
.final-table{
    table-layout: fixed;
    min-width: 1600px;
}

.final-table th{
    white-space: normal;     /* allow wrapping */
    line-height: 1.3;
    text-align: center;
    vertical-align: middle;
    padding: 10px 8px;
    font-size: 13px;
}
/* Store name */
.final-table th:nth-child(1),
.final-table td:nth-child(1){
    width: 180px;
    text-align: left;
}

/* Projection columns */
.final-table th:nth-child(2),
.final-table th:nth-child(3),
.final-table th:nth-child(4){
    width: 120px;
}

/* Metrics columns */
.final-table th:nth-child(5),
.final-table th:nth-child(6),
.final-table th:nth-child(7),
.final-table th:nth-child(8){
    width: 95px;
}

/* Input columns */
.final-table th:nth-child(9),
.final-table th:nth-child(10),
.final-table th:nth-child(11){
    width: 110px;
}

/* Percentage columns */
.final-table th:nth-child(12),
.final-table th:nth-child(13){
    width: 130px;
}

/* Last columns */
.final-table th:nth-child(14),
.final-table th:nth-child(15),
.final-table th:nth-child(16){
    width: 100px;
}
.final-table thead th{
    background: #0b4ea2;
    color: white;
    font-weight: 600;
    border-bottom: 2px solid #093a78;
}

/* ================= SECTION CARD ================= */
.section-card{
    background: rgba(255,255,255,0.92);
    border-radius:14px;
    padding:18px 20px 22px;
    margin:26px auto;
    box-shadow:0 12px 30px rgba(0,0,0,0.12);

    max-width: 1800px;   /* üî• increase white box width */
    width: 98%;
}



.section-title{
    font-size:18px;
    font-weight:700;
    margin-bottom:14px;
    color:#0b1f3b;
}

/* ================= CONTROLS ================= */
.controls{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
    margin-bottom:20px;
}

.controls button{
    background:linear-gradient(135deg,#0A66C2,#0078FF);
    border:none;
    border-radius:10px;
    padding:10px 16px;
    color:white;
    cursor:pointer;
    font-weight:700;
}

/* ================= SEARCH ================= */
.search-section{
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
    margin-bottom:20px;
}

/* ================= CLEAN TABLE ================= */
.clean-table{
    width:100%;
    border-collapse:separate;
    border-spacing:0;
    font-size:14px;
}

.clean-table thead th{
    background:#0b4ea2;
    color:white;
    padding:10px 12px;
    font-weight:600;
}

.clean-table tbody td{
    padding:9px 12px;
    border-bottom:1px solid #e3e6ec;
}

.clean-table tbody tr:hover{
    background:#f6f9ff;
}

.clean-table th:first-child,
.clean-table td:first-child{
    text-align:left;
}

.clean-table th:not(:first-child),
.clean-table td:not(:first-child){
    text-align:right;
}

.clean-table .total-row td{
    background:#b7c9e8;
    font-weight:700;
    border-top:2px solid #0b4ea2;
}

/* ================= STATUS COLORS ================= */
.dp-good{
    background:#c6efce;
    color:#006100;
    font-weight:600;
}

.dp-bad{
    background:#f8cbad;
    color:#9c0006;
    font-weight:600;
}

/* ================= FOOTER ================= */
footer{
    margin:30px 0 10px;
    font-size:13px;
    opacity:0.8;
    text-align:center;
}
</style>
</head>

<body>

<!-- ================= HEADER ================= -->
<div class="zippee-header">
    <h1>Zippee ‚Äì Store Projected Orders</h1>
    <i class="fa-solid fa-handshake-angle"></i>
</div>

<div class="main-container">

    <!-- ================= MAIN REPORT ================= -->
    <div class="section-card">
        <div class="section-title">üìä Store Projected Orders Report ‚Äì June Projection</div>
        <div class="datetime" id="datetime"></div>

        <div class="search-section">
            <label>Search before date:</label>
            <input type="date" id="searchDate">
            <input type="time" id="searchTime">
            <button id="searchBtn">Search</button>
        </div>

        <table id="reportTable" class="clean-table">
            <thead>
                <tr>
                    <th>Store Name</th>
                    <th>Projected Orders || <span id="currentDate"></span></th>
                    <th>Projected Orders | till <span id="tillHour">---</span></th>
                    <th>Projected Orders | till <span id="tillHourBuffer">---</span> (15% Buffer)</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- ================= UPLOAD + BUTTONS ================= -->
    <div class="section-card">
        <div class="section-title">üìÅ Upload Excel File</div>

        <div class="controls">
            <input type="file" id="fileInput">
            <button id="submitBtn">Submit</button>
            <button id="finalTableBtn" style="display:none;">Final Table</button>
            <button id="deepPainBtn">DeepPain Orders</button>
            <button id="DeepPainOrders_detailsBtn">DeepPain Orders Details</button>
        </div>

        <div id="output"></div>
    </div>

    <!-- ================= DEEP PAIN ORDERS ================= -->
    <div id="deepPainSection" class="section-card" style="display:none;">
        <div class="section-title">üî• DeepPain Orders</div>

        <input type="text" id="deepPainSearch" placeholder="Search by Store or Order Number">

        <table id="deepPainTable" class="clean-table">
            <thead>
                <tr>
                    <th>Order Number</th>
                    <th>Order Date</th>
                    <th>Store Name</th>
                    <th>Breached</th>
                    <th>Breached Duration</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <!-- ================= DEEP PAIN DETAILS ================= -->
    <div id="DeepPainOrders_detailsSection" class="section-card" style="display:none;">
        <div class="section-title">üìã DeepPain Orders Details</div>

        <input type="text" id="DeepPainOrders_detailsSearch" placeholder="Search details">

        <table id="DeepPainOrders_detailsTable" class="clean-table">
            <thead>
                <tr>
                    <th>Order Number</th>
                    <th>Order Date</th>
                    <th>Store</th>
                    <th>Breached</th>
                    <th>Duration</th>
                    <th>Status</th>
                    <th>Order Status</th>
                    <th>Customer</th>
                    <th>Other</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

</div>

<footer>
    ¬© Powered by SASA Automation | Harshit Saini ‚Äì Data Analyst, Zippee
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="Myntra_hdr_gsheet.js"></script>

</body>
</html>
